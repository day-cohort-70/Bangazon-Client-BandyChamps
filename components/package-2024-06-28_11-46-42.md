## ./filter.js
```
import { useEffect, useRef, useState } from 'react'
import { getCategories } from '../data/products'
import { Input, Select } from './form-elements'

export default function Filter({ productCount, onSearch, locations }) {
  const refEls = {
    location: useRef(),
    category: useRef(),
    name: useRef(),
    min_price: useRef(),
    order_by: useRef(),
    direction: useRef(),
    number_sold: useRef(),
  }

  const [showFilters, setShowFilters] = useState(false)
  const [query, setQuery] = useState('')
  const [categories, setCategories] = useState([{id: 1, name: 'Apples'}, {id: 2, name: 'Oranges'}, {id: 3, name: 'Lemons'}])
  const [direction, setDirection] = useState('asc')
  const clear = () => {
    for (let ref in refEls) {
      if (ref === 'direction') {
        refEls[ref].current.checked = false
        setDirection('asc')
      } else if (["min_price", "name"].includes(ref)) {
        refEls[ref].current.value = ""
      }
      else {
        refEls[ref].current.value = 0
      }
    }
    onSearch('')
  }
  const orderByOptions = [
    {
      id: 'price',
      name: 'Price'
    },
    {
      id: 'name',
      name: 'Name'
    }
  ]

  const directionOptions = [
    {
      name: 'direction',
      label: 'asc'
    },
    {
      name: 'direction',
      label: 'desc'
    },
  ]

  useEffect(() => {
    if (query) {
      onSearch(query)
    }
  }, [query])

  const buildQuery = (key, value) => {
    if (value && value !== "0") {
      return `${key}=${value}&`
    }
    return ""
  }

  const filter = () => {
    const newQuery = ""
    for (let refEl in refEls) {
      newQuery += buildQuery(refEl, refEls[refEl].current.value)
    }
    setQuery(newQuery)
  }

  return (
    <div className='level'>
      <div className="level-left">
        <div className="level-item">
          <p className="subtitle is-5">
            <strong>{productCount}</strong> products
          </p>
        </div>
        <div className="level-item">
          <Input
            placeholder="Find a Product"
            id="name"
            refEl={refEls.name}
            addlClass="has-addons"
            extra={
              <p className="control">
                <button className="button is-primary" onClick={filter}>
                  Search
                </button>
              </p>
            }
          />
        </div>
      </div>
      <div className="level-right">
        <div className="level-item">
          <div className={`dropdown is-right ${showFilters ? 'is-active' : ''}`}>
            <div className="dropdown-trigger">
              <button
                className="button"
                aria-haspopup="true"
                aria-controls="dropdown-menu"
                onClick={() => setShowFilters(!showFilters)}
              >
                <span>Filter Products</span>
                <span className="icon is-small">
                <i className="fas fa-filter"></i>
                </span>
              </button>
            </div>
            <div className="dropdown-menu" id="dropdown-menu" role="menu">
              <div className="dropdown-content">
                <div className="dropdown-item">
                  <Select
                    refEl={refEls.location}
                    options={locations}
                    title="Filter by Location"
                    addlClass="is-fullwidth"
                  />
                </div>
                <hr className="dropdown-divider"></hr>
                <div className="dropdown-item">
                  <Select
                    refEl={refEls.category}
                    options={categories}
                    title="Filter by Category"
                    addlClass="is-fullwidth"
                  />
                </div>
                <hr className="dropdown-divider"></hr>
                <div className="dropdown-item">
                  <Input
                    type="number"
                    placeholder="Minimum Price"
                    addlClass="is-horizontal"
                    refEl={refEls.min_price}
                  />

                </div>
                <hr className="dropdown-divider"></hr>
                <div className="dropdown-item">
                  <Input
                    type="number"
                    placeholder="Number Sold"
                    addlClass="is-horizontal"
                    refEl={refEls.number_sold}
                  />
                </div>
                <hr className="dropdown-divider"></hr>
                <div className="dropdown-item">
                  <Select
                    refEl={refEls.order_by}
                    options={orderByOptions}
                    title="Order by"
                    addlClass="is-fullwidth"
                  />
                  <div className="field">
                    <div className="control">
                      <label className="checkbox">
                        <input
                          type="checkbox"
                          value={direction}
                          ref={refEls.direction}
                          onChange={(event) => {
                            if (event.target.checked) {
                              setDirection('desc')
                            } else {
                              setDirection('asc')
                            }
                          }}
                        />
                        desc
                      </label>
                    </div>
                  </div>
                </div>
                <hr className="dropdown-divider"></hr>
                <div className="dropdown-item">
                  <div className="field is-grouped">
                    <p className="control">
                      <button className="button is-primary" onClick={filter}>
                        Filter
                      </button>
                    </p>
                    <p className="control">
                      <button className="button is-danger" onClick={clear}>
                        Clear
                      </button>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}
```
## ./table.js
```
export default function Table({ headers, footers = [], children }) {
  return (
    <>
      <table className="table">
        <thead>
          <tr>
            {
              headers.map((header, i) => <th key={`header--${i}`}>{header}</th>)
            }
          </tr>
        </thead>
        <tfoot>
          <tr>
            {
              footers.map((footer, i) => <th key={`footer--${i}`}>{footer}</th>)
            }
          </tr>
        </tfoot>
        <tbody>
          {children}
        </tbody>
      </table>
    </>
  )
}
```
## ./form-elements/index.js
```
import { Input } from "./input";
import { Select } from "./select"
import { Textarea } from "./textarea";

export {
  Input,
  Select,
  Textarea
}
```
## ./form-elements/input.js
```
export function Input({ id, type="text", placeholder="", refEl=undefined, label=undefined, onChangeEvent, addlClass="", children }) {
  return (
    <div className={`field ${addlClass}`}>
      {label && <label className="label">{label}</label>}
      <div className="control">
        <input
          id={id}
          placeholder={placeholder}
          className="input"
          type={type}
          ref={refEl}
          onChange={onChangeEvent}
        ></input>
      </div>
      {children}
    </div>
  )
}
```
## ./form-elements/textarea.js
```
export function Textarea({id, label, placeholder}) {
  return (
    <div className="field">
      <label className="label">{label}</label>
      <div className="control">
        <textarea id={id} className="textarea" placeholder={placeholder}></textarea>
      </div>
    </div>
  )
}
```
## ./form-elements/select.js
```
export function Select({id, refEl, options, title, label, addlClass = "" }) {
  return (
    <div className="field is-expanded">
      {label ? <label className="label">{label}</label> : <></>}
      <div className={`select ${addlClass} is-fullwidth`}>
        <select id={id} ref={refEl}>
          <option value="0">{title}</option>
          {
            options.map(option => (
              <option key={option.id} value={option.id}>{option.name}</option>
            ))
          }
        </select>
      </div>
    </div>
  )
}
```
## ./product/form.js
```
import { useEffect, useState } from 'react'
import { getCategories } from '../../data/products'
import CardLayout from '../card-layout'
import { Textarea, Select, Input } from '../form-elements'

export default function ProductForm({ formEl, saveEvent, title, router }) {
  const [categories, setCategories] = useState([])

  useEffect(() => {
    getCategories().then(catData => setCategories(catData))
  }, [])

  return (
    <CardLayout title={title}>
      <form ref={formEl}>
        <Input
          id="name"
          label="Name"
        />
        <Textarea
          id="description"
          label="Description"
        />
        <Select
          id="category"
          options={categories}
          label="Category"
          title="Select a Category"
        />
        <Input
          id="price"
          label="Price"
        />
        <Input
          id="location"
          label="Location"
        />
        <Input
          id="quantity"
          label="Quantity"
          type="number"
        />
      </form>
      <>
        <a className="card-footer-item" onClick={saveEvent}>Save</a>
        <a className="card-footer-item" onClick={() => router.back()}>Cancel</a>
      </>
    </CardLayout>
  )
}


```
## ./product/card.js
```
import Link from 'next/link'

export function ProductCard({ product, removeProduct, isOwner = false, width="is-one-quarter" }) {
  return (
    <div className={`column ${width}`}>
      <div className="card">
        <div className="card-image">
          <figure className="image is-4by3">
            <img src={product.image_path} alt="Placeholder image"></img>
          </figure>
        </div>
        <header className="card-header">
          <p className="card-header-title">
            <Link href={`/products/${product.id}`}><a>{product.name} - ${product.price}</a></Link>
          </p>
        </header>
        <div className="card-content">
          <div className="content">
            {product.description}
          </div>
        </div>
        {
          isOwner ?
            <footer className="card-footer">
              <Link href={`/products/${product.id}/edit`}><a className="card-footer-item">Edit</a></Link>
              <a onClick={() => removeProduct(product.id)} className="card-footer-item">Delete</a>
            </footer>
            :
            <></>
        }

      </div>
    </div>
  )
}
```
## ./product/detail.js
```
import { useRouter } from "next/router"
import { useState, useRef } from "react"
import { addProductToOrder, recommendProduct } from "../../data/products"
import Modal from "../modal"
import { Input } from "../form-elements"

export function Detail({ product, like, unlike }) {
  const router = useRouter()
  const usernameEl = useRef()
  const [showModal, setShowModal] = useState(false)
  const [showError, setShowError] = useState(false)


  const addToCart = () => {
    addProductToOrder(product.id).then(() => {
      router.push('/cart')
    })
  }

  const recommendProductEvent = () => {
    recommendProduct(product.id, usernameEl.current.value).then((res) => {
      if (res) {
        setShowError(true)
      } else {
        setShowModal(false)
        setShowError(false)
        usernameEl.current.value = ""
      }
    })
  }

  return (
    <>
      <Modal setShowModal={setShowModal} showModal={showModal} title="Recommend this product to a user">
        <Input id="username" label="Enter a username" refEl={usernameEl}>
          {
            showError ? <p className="help is-danger">This user doesn't exist</p> : <></>
          }
        </Input>
        <>
          <button className="button is-success" onClick={recommendProductEvent}>Recommend Product</button>
          <button className="button" onClick={() => setShowModal(false)}>Cancel</button>
        </>
      </Modal>
      <div className="tile is-ancestor">
        <div className="tile is-parent">
          <article className="tile is-child">
            <figure className="image is-4by3">
              <img src="https://bulma.io/images/placeholders/640x480.png"></img>
            </figure>
          </article>
        </div>
        <div className="tile is-parent is-vertical ">
          <article className="tile is-child">
            <h1 className="title">{product.name} - ${product.price}</h1>
            <p className="subtitle">{product.store?.name}</p>
            <p>{product.description}</p>
            <p>Pick up available in: {product.location}</p>
          </article>
          <article className="tile is-child is-align-self-center">
            <div className="field is-grouped">
              <p className="control">
                <button className="button is-primary" onClick={addToCart}>Add to Cart</button>
              </p>
              <p className="control">
                <button
                  className="button is-danger is-outlined"
                  onClick={() => setShowModal(true)}
                >Recommend this Product</button>
              </p>
              <p className="control">
                {
                  product.is_liked ?
                    <button className="button is-link is-outlined" onClick={unlike}>
                      <span className="icon is-small">
                        <i className="fas fa-heart-broken"></i>
                      </span>
                      <span>Unlike Product</span>
                    </button>
                    :
                    <button className="button is-link is-outlined" onClick={like}>
                      <span className="icon is-small">
                        <i className="fas fa-heart"></i>
                      </span>
                      <span>Like Product</span>
                    </button>
                }
              </p>
            </div>
          </article>
        </div>
      </div>
    </>
  )
}
```
## ./order/detail.js
```
import Table from "../table"

export default function CartDetail({ cart, removeProduct }) {
  const headers = ['Product', 'Price', '']
  const footers = ['Total', cart.total, '']

  return (
    <Table headers={headers} footers={footers}>
      {
        cart.products?.map(product => {
          return (
            <tr key={product.id}>
              <td>{product.name}</td>
              <td>{product.price}</td>
              <td>
                <span className="icon is-clickable" onClick={() => removeProduct(product.id)}>
                  <i className="fas fa-trash"></i>
                </span>
              </td>
            </tr>
          )
        })
      }
    </Table>
  )
}
```
## ./order/form-modal.js
```
import { useState } from "react"
import Modal from "../modal"

export default function CompleteFormModal({ showModal, setShowModal, paymentTypes, completeOrder }) {
  const [selectedPayment, setSelectedPayment] = useState(0)
  return (
    <Modal showModal={showModal} setShowModal={setShowModal} title="Complete Order">
      <div className="select">
        <select value={selectedPayment} onChange={(event) => setSelectedPayment(event.target.value)}>
          <option>Select a payment type to complete your order</option>
          {
            paymentTypes.map(pt => <option key={pt.id} value={pt.id}>{pt.merchant_name} {pt.obscured_num}</option>)
          }
        </select>
      </div>
      <>
        <button className="button is-success" onClick={() => completeOrder(selectedPayment)}>Complete Order</button>
        <button className="button" onClick={() => setShowModal(false)}>Cancel</button>
      </>
    </Modal>

  )
}
```
## ./store/form.js
```
import { Input } from '../../components/form-elements'
import CardLayout from '../card-layout'

export default function StoreForm({ nameEl, descriptionEl, saveEvent, title, router, children }) {
  return (
    <CardLayout title={title}>
      <>
        {children}
        <Input
          id="name"
          refEl={nameEl}
          type="text"
          placeholder="Store Name"
        />
        <textarea placeholder="Add a Description..." className="textarea" ref={descriptionEl}></textarea>
      </>
      <>
        <a className="card-footer-item" onClick={saveEvent}>Save</a>
        <a className="card-footer-item" onClick={() => router.back()}>Cancel</a>
      </>
    </CardLayout>
  )
}


```
## ./store/card.js
```
import Link from 'next/link'

export function StoreCard({ store, width= "is-half" }) {
  return (
    <div className={`column ${width}`}>
      <div className="card">
        <header className="card-header">
          <p className="card-header-title">
            {store.name}
          </p>
        </header>
        <div className="card-content">
          <p className="content">
            Owner: {store.seller.first_name} {store.seller.last_name}
          </p>
          <div className="content">
            {store.description}
          </div>
        </div>
        <footer className="card-footer">
          <Link href={`stores/${store.id}`}>
            <a className="card-footer-item">View Store</a>
          </Link>
        </footer>
      </div>
    </div>
  )
}
```
## ./store/detail.js
```
import Link from 'next/link'

export default function Detail({ store, isOwner, favorite, unfavorite }) {
  const ownerButtons = () => {
    return (
      <div className="buttons">
        <Link href={`/stores/${store.id}/edit`}>
          <a className="button is-primary is-inverted">
            Edit Store
          </a>
        </Link>
        <Link href="/products/new">
          <a className="button is-primary is-inverted">
            Add a Product
          </a>
        </Link>
      </div>
    )
  }
  const userButtons = () => {
    return (
      <>
        {
          store.is_favorite ?
            <button className="button is-primary is-inverted" onClick={unfavorite}>
              <span className="icon is-small">
                <i className="fas fa-heart-broken"></i>
              </span>
              <span>Unfavorite Store</span>
            </button>
            :
            <button className="button is-primary is-inverted" onClick={favorite}>
              <span className="icon is-small">
                <i className="fas fa-heart"></i>
              </span>
              <span>Favorite Store</span>
            </button>
        }
      </>
    )
  }

  return (
    <section className="hero is-primary mb-3">
      <div className="hero-head">
        <nav className="navbar">
          <div className="navbar-menu">
            <div className="navbar-end">
              <span className="navbar-item">
                {
                  isOwner ?
                    ownerButtons()
                    :
                    userButtons()
                }
              </span>
            </div>
          </div>
        </nav>
      </div>
      <div className="hero-body">
        <p className="title">
          {store.name}
        </p>
        <p className="subtitle">
          {store.description}
        </p>
      </div>
    </section>
  )
}
```
## ./layout.js
```
import Head from 'next/head'
import { AppWrapper } from '../context/state'

export default function Layout({ children }) {
  return (
    <AppWrapper>
      <>
        <Head>
          <title>Bangazon</title>
        </Head>
        <main className="container">{children}</main>
      </>
    </AppWrapper>
  )
}
```
## ./card-layout.js
```
export default function CardLayout({ title, children, width="is-6" }) {
  const [content, footer] = children
  return (
    <div className="columns is-centered is-vcentered">
      <div className={`column ${width}`}>
        <div className="card">
          <header className="card-header">
            <h3 className="card-header-title">
              {title}
            </h3>
          </header>
          <div className="card-content">
            <div className="content">
              {content}
            </div>
          </div>
          <footer className="card-footer">
            {footer}
          </footer>
        </div>
      </div>
    </div>
  )
}
```
## ./modal.js
```
export default function Modal({ showModal, setShowModal, title, children }) {
  const [body, footer] = children
  return (
    <div className={showModal ? "modal is-active" : "modal"}>
      <div className="modal-background"></div>
      <div className="modal-card">
        <header className="modal-card-head">
          <p className="modal-card-title">{title}</p>
          <button className="delete" aria-label="close" onClick={() => setShowModal(false)}></button>
        </header>
        <section className="modal-card-body">
          {body}
        </section>

        <footer className="modal-card-foot">
          {footer}
        </footer>
      </div>
    </div>
  )
}
```
## ./navbar.js
```
import Link from 'next/link'
import { useEffect, useState, useRef } from 'react'
import { useAppContext } from '../context/state'

export default function Navbar() {
  const { token, profile } = useAppContext()
  const hamburger = useRef()
  const navbar = useRef()
  const [isLoggedIn, setIsLoggedIn] = useState(false)

  useEffect(() => {
    if (token) {
      setIsLoggedIn(true)
    }
  }, [token])

  const showMobileNavbar = () => {
    hamburger.current.classList.toggle('is-active')
    navbar.current.classList.toggle('is-active')
  }

  const getLoggedInButtons = () => {
    return (
      <div className="navbar-item has-dropdown is-hoverable">
        <a className="navbar-link">
          <span className="icon">
            <i className="fas fa-user-circle is-medium"></i>
          </span>
        </a>
        <div className="navbar-dropdown is-right">
          <Link href="/cart"><a className="navbar-item">Cart</a></Link>
          <Link href="/my-orders"><a className="navbar-item">My Orders</a></Link>
          <Link href="/payments"><a className="navbar-item">Payment Methods</a></Link>
          <Link href="/profile"><a className="navbar-item">Profile</a></Link>
          {
            profile.store ?
              <>
                <Link href={`/stores/${profile.store.id}`}><a className="navbar-item">View Your Store</a></Link>
                <Link href="/products/new"><a className="navbar-item">Add a new Product</a></Link>
              </>
              :
              <Link href="/stores/new"><a className="navbar-item">Interested in selling?</a></Link>
          }
          <hr className="navbar-divider"></hr>
          <a className="navbar-item" onClick={
            () => {
              localStorage.removeItem('token')
              setIsLoggedIn(false)
            }}
          >
            Log out
          </a>
        </div>
      </div>
    )
  }

  const getLoggedOutButtons = () => {
    return (
      <div className="navbar-item">
        <div className="buttons">
          <Link href="/register">
            <a className="button is-primary">
              <strong>Sign up</strong>
            </a>
          </Link>
          <Link href="/login">
            <a className="button is-light">
              Log in
            </a>
          </Link>
        </div>
      </div>
    )
  }

  return (

    <nav className="navbar mb-3 is-warning px-5 is-fixed-top is-top" role="navigation" aria-label="main navigation">
      <div className="navbar-brand">

          <Link href="/">
            <img src="/images/logo.png" alt="Logo" style={{ width:"4rem", height: "4rem"}} className="relative" />
          </Link>


        <a role="button" className="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample" ref={hamburger} onClick={showMobileNavbar}>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>

      <div className="navbar-menu" ref={navbar}>
        <div className="navbar-start">
          <Link href="/products"><a className="navbar-item">Products</a></Link>
          <Link href="/stores"><a className="navbar-item">Stores</a></Link>
        </div>
        <div className="navbar-end">
          {
            isLoggedIn ? getLoggedInButtons() : getLoggedOutButtons()
          }
        </div>
      </div>
    </nav>
  )
}
```
## ./rating/header.js
```
export function Header({ averageRating, ratingsLen, numberPurchased, likesLength }) {
  return (
    <div className="tile is-parent is-12">
      <div className="tile is-child">
        <section className="level has-background-primary">
          <div className="level-item has-text-centered">
            <div>
              <p className="heading">Avg. Rating</p>
              <p className="title">{averageRating}</p>
            </div>
          </div>
          <div className="level-item has-text-centered">
            <div>
              <p className="heading"># of Reviews</p>
              <p className="title">{ratingsLen}</p>
            </div>
          </div>
          <div className="level-item has-text-centered">
            <div>
              <p className="heading">Purchased</p>
              <p className="title">{numberPurchased} times</p>
            </div>
          </div>
          <div className="level-item has-text-centered">
            <div>
              <p className="heading">Likes</p>
              <p className="title">{likesLength}</p>
            </div>
          </div>
        </section>
      </div>
    </div>
  )
}
```
## ./rating/form.js
```
import { Rating } from 'react-simple-star-rating'
import { useState } from 'react'

export default function RatingForm({ saveRating }) {
  const [rating, setRating] = useState(0)
  const [comment, setComment] = useState("")
  
  const submitRating = () => {
    const outOf5 = rating/20
    saveRating({
      score: outOf5,
      review: comment
    })
  }



  return (
    <div className="tile is-child ">
      <article className="media box">
        <figure className="media-left">
          <Rating onClick={setRating} ratingValue={rating} />
        </figure>
        <div className="media-content">
          <div className="field">
            <p className="control">
              <textarea className="textarea" placeholder="Add your review" value={comment} onChange={(e) => setComment(e.target.value)}></textarea>
            </p>
          </div>
          <div className="field">
            <p className="control">
              <button className="button" onClick={submitRating}>Post Rating</button>
            </p>
          </div>
        </div>
      </article>
    </div>
  )
}
```
## ./rating/container.js
```
import { RatingCard } from './card'
import RatingForm from './form'

export function RatingsContainer({ ratings, saveRating }) {
  return (
    <div className="tile is-parent is-12 is-vertical container">
      <RatingForm saveRating={saveRating} />
      {
        ratings?.map((rating) => <RatingCard key={rating.id} rating={rating} />)
      }
    </div>
  )
}
```
## ./rating/card.js
```
import { Rating } from 'react-simple-star-rating'

export function RatingCard({ rating }) {
  return (
    <div className="tile is-child">
      <article className="media box is-align-items-center">
        <figure className="media-left">
          <Rating initialValue={rating.score} readonly={true} />
        </figure>
        <div className="media-content">
          <div className="content">
            <p>
              {rating.review}
            </p>
          </div>
        </div>
      </article>
    </div>
  )
}
```
## ./rating/detail.js
```
import { useState, useEffect } from 'react'
import { rateProduct } from '../../data/products'
import { RatingsContainer } from './container'
import { Header } from './header'

export function Ratings({ average_rating, refresh, ratings = [], number_purchased, likes = [] }) {
  const [productId, setProductId] = useState(0)
  const saveRating = (newRating) => {
    rateProduct(productId, newRating).then(refresh)

  }

  useEffect(() => {
    if (ratings.length) {
      setProductId(ratings[0].product)
    }
  }, [ratings])

  return (
    <div className="tile is-ancestor is-flex-wrap-wrap">
      <Header 
        averageRating={average_rating}
        ratingsLen={ratings.length}
        numberPurchased={number_purchased}
        likesLength={likes.length}
      />
      <RatingsContainer ratings={ratings} saveRating={saveRating} />
    </div>
  )
}
```
## ./payments/payment-modal.js
```
import { useRef } from "react"
import { Input } from "../form-elements"
import Modal from "../modal"

export default function AddPaymentModal({ showModal, setShowModal, addNewPayment }) {
  const merchantNameInput = useRef()
  const acctNumInput = useRef()
  return (
    <Modal showModal={showModal} setShowModal={setShowModal} title="Add New Payment Method">
      <>
        <Input
          id="merchantName"
          type="text"
          label="Merchant Name"
          refEl={merchantNameInput}
        />
        <Input
          id="accNum"
          type="text"
          label="Account Number"
          refEl={acctNumInput}
        />
      </>
      <>
        <button
          className="button is-success"
          onClick={() => addNewPayment({
            acctNumber: acctNumInput.current.value,
            merchant: merchantNameInput.current.value
          })}
        >Add Payment Method</button>
        <button className="button" onClick={() => setShowModal(false)}>Cancel</button>
      </>
    </Modal>
  )
}
```
